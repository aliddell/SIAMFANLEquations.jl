<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · SIAMFANLEquations.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="SIAMFANLEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">SIAMFANLEquations.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Scalar-Equations:-Chapter-1"><span>Scalar Equations: Chapter 1</span></a></li><li><a class="tocitem" href="#Nonlinear-systems-with-direct-linear-solvers:-Chapter-2"><span>Nonlinear systems with direct linear solvers: Chapter 2</span></a></li><li><a class="tocitem" href="#Overview-of-the-Codes"><span>Overview of the Codes</span></a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="functions/nsol/">nsol: systems of equations with direct linear solvers</a></li><li><a class="tocitem" href="functions/ptcsol/">ptcsol: Pseudo-Transient Continuation Solver</a></li><li><a class="tocitem" href="functions/nsoli/">nsoli: systems of equations with Krylov linear solvers</a></li></ul></li><li><span class="tocitem">Scalar Equations</span><ul><li><a class="tocitem" href="functions/nsolsc/">nsolsc: scalar equation solver</a></li><li><a class="tocitem" href="functions/ptcsolsc/">ptcsolsc: pseudo-transient continuation</a></li><li><a class="tocitem" href="functions/secant/">secant: scalar equation solver</a></li></ul></li><li><span class="tocitem">Linear Solvers</span><ul><li><a class="tocitem" href="functions/kl_gmres/">kl_gmres: GMRES linear solver</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ctkelley/SIAMFANLEquations.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SIAMFANLEquations.jl-v0.3.0"><a class="docs-heading-anchor" href="#SIAMFANLEquations.jl-v0.3.0">SIAMFANLEquations.jl v0.3.0</a><a id="SIAMFANLEquations.jl-v0.3.0-1"></a><a class="docs-heading-anchor-permalink" href="#SIAMFANLEquations.jl-v0.3.0" title="Permalink"></a></h1><p><a href="https://ctk.math.ncsu.edu">C. T. Kelley</a></p><p><a href="https://github.com/ctkelley/SIAMFANLEquations.jl">SIAMFANLEquations.jl</a> is the package of solvers and test problems for the book</p><p><strong>Solving Nonlinear Equations with Iterative Methods:</strong> <strong>Solvers and Examples in Julia</strong></p><p>This documentation is sketchy and designed to get you going, but the real deal is the <a href="https://github.com/ctkelley/NotebookSIAMFANL">IJulia notebook</a></p><p>This is version 0.3.0. </p><p>This version will feature <strong>Chapter 3</strong>, Newton-Krylov solvers. </p><p>I am writing my own Krylov solvers so they will communicate with  the nonlinear solvers the way I want and so I can do GMRES my way  (classical Gram-Schmidt twice!). </p><p>Version 0.3.0 has</p><ol><li>GMRES linear solver, <strong>kl_gmres.jl</strong></li><li>Newton-Krylov solver, <strong>nsoli.jl</strong> a) uses the line search from Chapter 2</li><li>The examples from FA1 that I plan to keep</li></ol><p>Version 0.3.1 will get</p><ol><li>GMRES(m)</li><li>PTC </li><li>BiCGstab linear solver</li></ol><p>Version 0.3.2 comes out when the notebook is done and everything works.</p><p>Version 0.3.3 happens when the chapter is done for the print book and the maps print &lt;–&gt; notebook are complete.</p><h2 id="Scalar-Equations:-Chapter-1"><a class="docs-heading-anchor" href="#Scalar-Equations:-Chapter-1">Scalar Equations: Chapter 1</a><a id="Scalar-Equations:-Chapter-1-1"></a><a class="docs-heading-anchor-permalink" href="#Scalar-Equations:-Chapter-1" title="Permalink"></a></h2><h3 id="Algorithms"><a class="docs-heading-anchor" href="#Algorithms">Algorithms</a><a id="Algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithms" title="Permalink"></a></h3><p>The examples in the first chapter are scalar equations that illustrate many of the important ideas in nonlinear solvers. </p><ol><li>infrequent reevaluation of the derivative </li><li>secant equation approximation of the derivative</li><li>line searches</li><li>pseudo-transient continuation</li></ol><p>Leaving out the kwargs, the calling sequence for getting nsolsc to solve <span>$f(x) = 0$</span> is</p><pre><code class="language-julia">nsolsc(f,x, fp=difffp)</code></pre><p>Here x is the initial iterate and fp (optional) is the function for evaluating the derivative. If you leave fp out, nsold uses a forward difference approximation.</p><p>See the code overview or the notebook for details. Here are a couple  of simple examples.</p><p>Solve <span>$atan(x) = 0$</span> with <span>$x_0 = 0$</span> as the initial iterate and a finite difference approximation to the derivative. The output of nsolsc is a tuple. The history vector contains the nonlinear residual norm. In this example I&#39;ve limited the number of iterations to 5, so history has 6 components (including the initial residual, iteration 0).</p><pre><code class="language-julia">julia&gt; nsolout=nsolsc(atan,1.0;maxit=5,atol=1.e-12,rtol=1.e-12);

julia&gt; nsolout.history
6-element Array{Float64,1}:
 7.85398e-01
 5.18669e-01
 1.16332e-01
 1.06102e-03
 7.96200e-10
 2.79173e-24</code></pre><p>Now try the same problem with the secant method. I&#39;ll need one more iteration to meet the termination criterion.</p><pre><code class="language-julia">julia&gt; secout=secant(atan,1.0;maxit=6,atol=1.e-12,rtol=1.e-12);


julia&gt; secout.history
7-element Array{Float64,1}:
 7.85398e-01
 5.18729e-01
 5.39030e-02
 4.86125e-03
 4.28860e-06
 3.37529e-11
 2.06924e-22</code></pre><p>In this example I define a function and its derivative and send that to nsolsc. I print both the history vectors and the solution history.</p><pre><code class="language-julia">julia&gt; fs(x)=x^2-4.0; fsp(x)=2x;

julia&gt; nsolout=nsolsc(fs,1.0,fsp; maxit=5,atol=1.e-9,rtol=1.e-9);

julia&gt; [nsolout.solhist.-2 nsolout.history]
6×2 Array{Float64,2}:
 -1.00000e+00  3.00000e+00
  5.00000e-01  2.25000e+00
  5.00000e-02  2.02500e-01
  6.09756e-04  2.43940e-03
  9.29223e-08  3.71689e-07
  2.22045e-15  8.88178e-15</code></pre><h2 id="Nonlinear-systems-with-direct-linear-solvers:-Chapter-2"><a class="docs-heading-anchor" href="#Nonlinear-systems-with-direct-linear-solvers:-Chapter-2">Nonlinear systems with direct linear solvers: Chapter 2</a><a id="Nonlinear-systems-with-direct-linear-solvers:-Chapter-2-1"></a><a class="docs-heading-anchor-permalink" href="#Nonlinear-systems-with-direct-linear-solvers:-Chapter-2" title="Permalink"></a></h2><p>The ideas from Chapter 1 remain important here. For systems the Newton step is the solution of the linear system</p><p><span>$F&#39;(x) s = - F(x)$</span></p><p>This chapter is about solving the equation for the Newton step with Gaussian elimination. Infrequent reevaluation of <span>$F&#39;$</span>means that we also factor <span>$F&#39;$</span> infrequently, so the impact of this idea is greater. Even better, there is typically no loss in the nonlinear iteration if we do that factorization in single precision. You an make that happen by giving nsold and ptcsold the single precision storage for the Jacobian. Half precision is also possible, but is a very, very bad idea. </p><p>Bottom line: <strong>single precision can cut the linear algebra cost in half with no loss in the quality of the solution or the number of nonlinear iterations it takes to get there.</strong></p><h2 id="Overview-of-the-Codes"><a class="docs-heading-anchor" href="#Overview-of-the-Codes">Overview of the Codes</a><a id="Overview-of-the-Codes-1"></a><a class="docs-heading-anchor-permalink" href="#Overview-of-the-Codes" title="Permalink"></a></h2><p>The core solvers (so far) are </p><ol><li><p>nsol.jl is is all variations of Newton&#39;s method <strong>except</strong> pseudo transient continuation. The methods are</p><ul><li>Newton&#39;s method</li><li>The Shamanskii method, where the derivative evaluation is done every m iterations. <span>$m=1$</span> is Newton and <span>$m=\infty$</span> is chord.</li><li>I do an Armijo line search for all the methods unless the method is chord or you tell me not to.</li></ul></li><li><p>ptcsol.jl is pseudo-transient continuation.</p></li></ol><p>The solvers for scalar equations are wrappers for the core codes with the same interface. The expectation is that the scalar codes do not need to manage linear algebra or storage of arrays.</p><h3 id="Scalar-Equations:-Chapter-1-2"><a class="docs-heading-anchor" href="#Scalar-Equations:-Chapter-1-2">Scalar Equations: Chapter 1</a><a class="docs-heading-anchor-permalink" href="#Scalar-Equations:-Chapter-1-2" title="Permalink"></a></h3><p>There are two codes for the methods in this chapter</p><ol><li><p>nsolsc.jl is all variations of Newton&#39;s method <strong>except</strong>  pseudo transient continuation. The methods are</p><ul><li>Newton&#39;s method </li><li>The Shamanskii method, where the derivative evaluation is done every m iterations. <span>$m=1$</span> is Newton and <span>$m=\infty$</span> is chord.</li><li>I do an Armijo line search for all the methods unless the method is chord or you tell me not to.</li></ul></li><li><p>secant.jl is the scalar secant method. It is a stand-alone code.</p></li></ol><p>I do not know if I&#39;ll merge it with the Broyden code or not. It&#39;s really too simple to mess with much.</p><ol><li>ptcsolsc.jl is pseudo-transient continuation. </li></ol><h3 id="Nonlinear-systems-with-direct-linear-solvers:-Chapter-2-2"><a class="docs-heading-anchor" href="#Nonlinear-systems-with-direct-linear-solvers:-Chapter-2-2">Nonlinear systems with direct linear solvers: Chapter 2</a><a class="docs-heading-anchor-permalink" href="#Nonlinear-systems-with-direct-linear-solvers:-Chapter-2-2" title="Permalink"></a></h3><p>This is the same story as it was for scalar equations, &#39;ceptin for the linear algebra. The linear solvers for this chapter are the matrix factorizations that live in LinearAlgebra, SuiteSparse, or BandedMatrices. </p><h3 id="Nonlinear-systems-with-iterative-linear-solvers:-Chapter-3"><a class="docs-heading-anchor" href="#Nonlinear-systems-with-iterative-linear-solvers:-Chapter-3">Nonlinear systems with iterative linear solvers: Chapter 3</a><a id="Nonlinear-systems-with-iterative-linear-solvers:-Chapter-3-1"></a><a class="docs-heading-anchor-permalink" href="#Nonlinear-systems-with-iterative-linear-solvers:-Chapter-3" title="Permalink"></a></h3><ol><li>The logic in Newton-Krylov methods is different enough from that</li></ol><p>of nsol and ptcsol that I&#39;m making nsoli and ptcsoli their own codes. </p><ol><li>The Newton-Krylov linear solver nsoli.jl is done and the documentation </li></ol><p>is in here. It works with GMRES now. Bi-CGSTAB is coming, but PTC and GMRES(m) will come first.</p><h3 id="Krylov-linear-solvers."><a class="docs-heading-anchor" href="#Krylov-linear-solvers.">Krylov linear solvers.</a><a id="Krylov-linear-solvers.-1"></a><a class="docs-heading-anchor-permalink" href="#Krylov-linear-solvers." title="Permalink"></a></h3><ol><li>kl_gmres: GMRES with orthogonalization via classical Gram-Schmidt twice. Restarts are not in there yet.</li></ol></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="functions/nsol/">nsol: systems of equations with direct linear solvers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 30 January 2021 21:47">Saturday 30 January 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
